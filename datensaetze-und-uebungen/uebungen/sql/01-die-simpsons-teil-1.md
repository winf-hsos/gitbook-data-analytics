# ⭐ Die Simpsons Teil 1

## Vorbereitung

Importiert das folgende Notebook als Template für die Aufgaben unten. Das Notebook enthält einen Block für das Importieren der Daten in euren Databricks-Account. Fügt anschließend die Lösungen als neue Blöcke in das Notebook. Kopiert die Fragen in die Überschrift des Blocks mit der jeweiligen Lösung!

[Link zum Notebook](https://s3.amazonaws.com/nicolas.meseth/databricks-notebooks/template\_simpsons.html)

## Aufgabe

### 1. Den Datensatz erkunden

Beantwortet die folgenden Fragen, um den Datensatz unabhängig von seinem Inhalt besser kennenzulernen:

#### Aus wie vielen Tabellen besteht der Datensatz?

#### Wie viele Zeilen hat jede Tabelle?

#### Welche Spalten haben die Tabellen? Was ist der Datentyp jeder Spalte? Was könnte der Inhalt sein?

#### Welche Wertebereiche weisen die Spalten auf?

### 2. Beantwortet die folgenden Fragen mit einem SQL-Statement!

Bevor ihr mit dem Schreiben des SQL-Statements beginnt, überlegt euch die folgenden Punkte:

#### Wie müsste das Ergebnis aussehen, um die Frage beantworten zu können? Ist es _ein_ Wert? Sind es _mehrere_ Werte in _einer_ Zeile? Sind es mehrere Zeilen? Suchen wir eine _bestimmte_ Zeile, oder ist das Ergebnis die Zusammenfassung mehrerer Zeilen?

#### Welche Tabellen und welche Spalten enthalten die gesuchte Information? Schaut dazu in das Datenmodell.

Versucht euch nun an diesen Fragen:

#### Frage 1: Wie viele Simpsons Episoden gibt es insgesamt im Datensatz?

#### Frage 2: Wie viele Charaktere sind weiblich?

#### Frage 3: Wie ist das zahlenmäßige Verhältnis zwischen weiblichen und männlichen Charakteren?

#### Frage 4: Wie viele Folgen haben ein IMDB-Rating von 9 oder höher?

#### Frage 5: Wie viele Folgen wurden 1995 zum ersten Mal ausgestrahlt?

#### Frage 6: Wie oft wir Barack Obama in allen Episoden genannt?

#### Frage 7: Welcher Charakter spricht am meisten?

#### Frage 8: Wie oft sagen Charaktere außer Homer das Wort "Donut"?

#### Frage 9: Wer erklärt Homer das Wort „Schadenfreude“?

#### Frage 10: Gibt es eine Folge, in der Lisa kein einziges Mal spricht?

## Datenmodell

Die Grafik unten zeigt die vier Tabellen mit den Spalten. Die Pfeile zeigen die Beziehungen zwischen den Tabellen an.

![Das Datenmodell der vier Tabellen des Simpsons-Datensatzes.](<../../../.gitbook/assets/image (24).png>)

## Lösung

### 1. Den Datensatz erkunden

#### Wie viele Zeilen hat jede Tabelle?

{% embed url="https://www.youtube.com/watch?v=bD3IU8fKvxw" %}

#### Welche Spalten haben die Tabellen? Was ist der Datentyp jeder Spalte? Was könnte der Inhalt sein?

{% embed url="https://www.youtube.com/watch?v=sgZaTPg7jt4" %}

#### Welche Wertebereiche weisen die Spalten auf?

{% embed url="https://www.youtube.com/watch?v=Nq5or0VstO0" %}

### 2. Beantwortet die folgenden Fragen mit einem SQL-Statement!

#### Wie müsste das Ergebnis aussehen, um die Frage beantworten zu können? Ist es _ein_ Wert? Sind es _mehrere_ Werte in _einer_ Zeile? Sind es mehrere Zeilen? Suchen wir eine _bestimmte_ Zeile, oder ist das Ergebnis die Zusammenfassung mehrerer Zeilen?

#### Welche Tabellen und welche Spalten enthalten die gesuchte Information? Schaut dazu in das Datenmodell.

{% embed url="https://www.youtube.com/watch?v=x4qpgjN5ZSU" %}

#### Frage 1: Wie viele Simpsons Episoden gibt es insgesamt im Datensatz?

{% embed url="https://www.youtube.com/watch?v=GFCKlzMJ_R4" %}

#### Frage 2: Wie viele Charaktere sind weiblich?

{% embed url="https://www.youtube.com/watch?v=1vjCtvsd83Q" %}

#### Frage 3: Wie ist das zahlenmäßige Verhältnis zwischen weiblichen und männlichen Charakteren?

{% embed url="https://www.youtube.com/watch?v=Cn6kla9CchI" %}

{% embed url="https://www.youtube.com/watch?v=yylKKT1kpzA" %}

#### Frage 4: Wie viele Folgen haben ein IMDB-Rating von 9 oder höher?

{% embed url="https://youtu.be/g0AywyzqMt4" %}

#### Frage 5: Wie viele Folgen wurden 1995 zum ersten Mal ausgestrahlt?

{% embed url="https://www.youtube.com/watch?v=QMU9uw0Megs" %}

#### Frage 6: Wie oft wir Barack Obama in allen Episoden genannt?

{% embed url="https://www.youtube.com/watch?v=0FjlSHSmA5A" %}
